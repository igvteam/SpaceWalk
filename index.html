<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>Tracing 3D</title>

    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">

    <!-- Bootstrap 4 CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

    <!-- DataTables CSS -->
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css"/>

    <!-- Juicebox CSS-->
    <link rel="stylesheet" type="text/css" href="css/juicebox.css">

    <!-- APP CSS -->
    <link rel="stylesheet" href="css/app.css">

    <!-- Bootstrap 4 & Dependancy JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- Resizable DOM Element Events JS   -->
    <script type="text/javascript" src="vendor/detect-element-resize.js"></script>

    <!-- Dropbox Chooser API -->
    <script src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="8glijwyao9fq8we"></script>

    <!-- Datatables JS -->
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

    <!-- Google Platform JS -->
    <script src="https://apis.google.com/js/platform.js"></script>

    <!-- IGV JS -->
    <script src="https://cdn.jsdelivr.net/npm/igv@2.2.6/dist/igv.min.js"></script>

    <!-- MS polyfill (pointer -> touch -->
    <script src="https://igv.org/web/jb/release/current/touchpolyfill.min.js"></script>

    <script type="x-shader/x-vertex" id="diffuse_cube_vert">

        vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
            return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
        }

        // vNormalWorldSpace - world space
        varying vec3 vNormalWorldSpace;

        // vNormalEyeSpace - the eye space normal
        varying vec3 vNormalEyeSpace;
        void main() {

            // Use the normalMatrix to convert the world space normal eye space
            // normalMatrix = transpose( inverse( modelViewMatrix ) )
            vNormalEyeSpace = normalMatrix * vec4(normal, 1.0).xyz;

            vNormalWorldSpace = inverseTransformDirection(vNormalEyeSpace, viewMatrix);

            gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
        }
    </script>

    <script type="x-shader/x-fragment" id="diffuse_cube_frag">
        uniform samplerCube cubicMap;
        varying vec3 vNormalWorldSpace;
        varying vec3 vNormalEyeSpace;
        void main() {
            vec3 index = vec3(-vNormalWorldSpace.x, vNormalWorldSpace.y, vNormalWorldSpace.z);
            vec3 rgb = textureCube(cubicMap, index).rgb;
            gl_FragColor = vec4(rgb, 1.0);
        }
    </script>

    <script type="x-shader/x-vertex" id="show_st_vert">
        varying vec2 vST;
        void main() {
            vST = uv;
            gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
        }
    </script>

    <script type="x-shader/x-fragment" id="show_st_frag">
        uniform int showS;
        uniform int showT;
        varying vec2 vST;
        void main() {

            if (showS == 1 && showT == 1) {
                gl_FragColor = vec4(vST.s, vST.t, 0.0, 1.0);
            } else if (showS == 1 && showT == 0) {
                gl_FragColor = vec4(vST.s, 0.0, 0.0, 1.0);
            } else if (showS == 0 && showT == 1){
                gl_FragColor = vec4(0.0, vST.t, 0.0, 1.0);
            } else {
                gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
            }
        }
    </script>

    <script type="module" src="js/app.js"></script>

</head>

<body>

<nav class="navbar fixed-top py-0 navbar-expand-sm navbar-dark bg-dark justify-content-between">

    <!-- Brand -->
    <span class="navbar-brand">SpaceWalk</span>

    <!-- Brand -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#tracing3d-navbar-content">
        <span class="navbar-toggler-icon"></span>
    </button>

    <!-- navbar content -->
    <div id="tracing3d-navbar-content" class="collapse navbar-collapse d-flex flex-row ml-5">
        <ul class="navbar-nav">

            <!-- Structure Files -->
            <li class="nav-item">

                <div class="dropdown">

                    <a id="trace3d-file-load-dropdown-button"  data-toggle="dropdown" href="#" class="nav-link dropdown-toggle">
                        Load Structure
                    </a>

                    <div id="trace3d-file-load-dropdown-menu"  class="dropdown-menu">

                        <!-- select -->
                        <button id="trace3d-file-load-select-button" class="dropdown-item" type="button" data-toggle="modal" data-target="#trace3d-file-load-select-modal">Select From List ...
                        </button>

                        <!-- local file -->
                        <label class="dropdown-item btn btn-default btn-file">
                            <div>
                                <div>
                                    Local File ...
                                </div>
                                <div>
                                    <input id="trace3d-file-load-local-input" type="file" name="file" style="display: none;">
                                </div>
                            </div>
                        </label>

                        <!-- url -->
                        <button id="trace3d-file-load-url-button" class="dropdown-item" type="button" data-toggle="modal" data-target="#trace3d-file-load-url-modal">URL ...
                        </button>

                    </div>

                </div>

            </li>

            <!-- IGV Track Files -->
            <li class="nav-item">

                <div class="dropdown">

                    <a id="trace3d-igv-load-dropdown-button"  data-toggle="dropdown" href="#" class="nav-link dropdown-toggle">
                        Load IGV Track
                    </a>

                    <!-- -->
                    <div id="igv-app-track-dropdown-menu" class="dropdown-menu">

                        <!-- local file -->
                        <label class="dropdown-item btn btn-default btn-file">
                            <div class="igv-app-dropdown-item-cloud-storage">
                                <div>
                                    Local File ...
                                </div>
                                <div>
                                    <input id="igv-app-dropdown-local-track-file-input" type="file" name="file" multiple style="display: none;">
                                </div>
                            </div>
                        </label>

                        <!-- Dropbox -->
                        <div class="dropdown-item">

                            <div id="igv-app-dropdown-dropbox-track-file-button" class="igv-app-dropdown-item-cloud-storage">

                                <div>Dropbox</div>
                                <div><img src="img/dropbox-dropdown-menu-item.png" width="18" height="18"></div>
                                <div>...</div>

                            </div>

                        </div>

                        <!-- Google Drive -->
                        <div class="dropdown-item">
                            <div id="igv-app-dropdown-google-drive-track-file-button" class="igv-app-dropdown-item-cloud-storage">
                                <div>Google Drive</div>
                                <div><img src="img/googledrive-dropdown-menu-item.png" width="18" height="18"></div>
                                <div>...</div>
                            </div>
                        </div>

                        <!-- URL -->
                        <button class="dropdown-item" type="button" data-toggle="modal" data-target="#igv-app-track-from-url-modal">URL ...
                        </button>

                        <div id="igv-app-annotations-section" class="dropdown-divider"></div>

                    </div>

                </div>

            </li>

            <!-- Hi-C Files -->
            <li class="nav-item">

                <div class="dropdown">

                    <a id="trace3d-juicebox-load-dropdown-button" data-toggle="dropdown" href="#" class="nav-link dropdown-toggle">
                        Load Map File
                    </a>

                    <div id="trace3d-juicebox-load-dropdown-menu"  class="dropdown-menu">

                        <!-- select -->
                        <button id="trace3d-juicebox-load-select-button" class="dropdown-item" type="button" data-toggle="modal" data-target="#hic-contact-map-select-modal">
                            Select Map File
                        </button>

                        <!-- local file -->
                        <label class="dropdown-item btn btn-default btn-file">
                            <div>
                                <div>
                                    Local Map File ...
                                </div>
                                <div>
                                    <input id="trace3d-juicebox-load-local-input" type="file" name="file" style="display: none;">
                                </div>
                            </div>
                        </label>

                        <!-- url -->
                        <button id="trace3d-juicebox-load-url-button" class="dropdown-item" type="button" data-toggle="modal" data-target="#hic-load-url-modal">Map URL ...
                        </button>

                    </div>

                </div>

            </li>

            <li class="nav-item">
                <div id="trace3d-file-name" class="navbar-brand"></div>
            </li>

        </ul>
    </div>


</nav>

<main>

    <div id="trace3d_canvas_container">

        <!-- UI Manager Button -->
        <div id="trace3d_ui_manager_button">
            <i class="fas fa-cog fa-2x"></i>
        </div>

        <!-- UI Manager Panel -->
        <div id="trace3d_ui_manager_panel" class="card" style="display:none;">
            <ul class="list-group list-group-flush">

                <!-- toggle groundplane -->
                <li class="list-group-item">
                    <input id="trace3d_ui_manager_groundplane" class="mr-2" type="checkbox">
                    <div>Groundplane</div>
                </li>

                <!-- toggle all UI controls -->
<!--                <li class="list-group-item">-->
<!--                    <input id="trace3d_ui_manager_ui_controls" class="mr-2" type="checkbox" checked>-->
<!--                    <div>All UI Controls</div>-->
<!--                </li>-->

                <!-- toggle color ramp panel -->
                <li class="list-group-item">
                    <input id="trace3d_ui_manager_ui_controls_color_ramp" data-target="trace3d_color_ramp_panel" class="mr-2" type="checkbox" checked>
                    <div>Color Ramp</div>
                </li>

                <!-- toggle structure select panel -->
                <li class="list-group-item">
                    <input id="trace3d_ui_manager_ui_controls_structure_select" data-target="trace3d_structure_select_panel" class="mr-2" type="checkbox" checked>
                    <div>Structure Select</div>
                </li>

                <!-- toggle juicebox panel -->
                <li class="list-group-item">
                    <input id="trace3d_ui_manager_ui_controls_juicebox" data-target="trace3d_juicebox_panel" class="mr-2" type="checkbox" checked>
                    <div>Juicebox</div>
                </li>

                <!-- toggle igv panel -->
                <li class="list-group-item">
                    <input id="trace3d_ui_manager_ui_controls_igv" data-target="trace3d_igv_panel" class="mr-2" type="checkbox" checked>
                    <div>IGV</div>
                </li>

                <!-- toggle thumbnail panel -->
                <li class="list-group-item">
                    <input id="trace3d_ui_manager_ui_controls_thumbnail" data-target="trace3d_thumbnail_panel" class="mr-2" type="checkbox">
                    <div>Thumbnail</div>
                </li>

                <!-- toggle render style -->
                <li class="list-group-item">
                    <div class="trace3d_ui_manager_render_style_container">
                        <div class="form-check">
                            <input name="trace3d-render-style" id="trace3d-render-style-ball-stick" class="form-check-input" type="radio">
                            <label class="form-check-label" for="trace3d-render-style-ball-stick">
                                Ball & Stick
                            </label>
                        </div>
                        <div class="form-check">
                            <input name="trace3d-render-style" id="trace3d-render-style-noodle" class="form-check-input" type="radio" checked>
                            <label class="form-check-label" for="trace3d-render-style-noodle">
                                Noodle
                            </label>
                        </div>
                    </div>
                </li>
            </ul>
        </div>

        <!-- color ramp panel -->
        <div id="trace3d_color_ramp_panel" class="card">

            <div id="trace3d_color_ramp_widget_container" class="card-body">

                <div class="trace3d_card_drag_container">
                    <i class="fas fa-sm fa-grip-horizontal"></i>
                </div>

                <div id="trace3d_color_ramp_header">
                </div>

                <div id="trace3d_color_ramp_canvas_container">
                    <canvas id="trace3d_color_ramp_canvas_highlight"></canvas>
                    <canvas id="trace3d_color_ramp_canvas_rgb"></canvas>
                    <canvas id="trace3d_color_ramp_canvas_alpha"></canvas>
                </div>

                <div id="trace3d_color_ramp_footer">
                </div>

            </div>

        </div>

        <!-- structure select panel -->
        <div id="trace3d_structure_select_panel" class="card">

            <div class="card-body">

                <div class="trace3d_card_drag_container">
                    <i class="fas fa-sm fa-grip-horizontal"></i>
                </div>

                <!-- header -->
                <div id="trace3d_structure_select_header" class="text-center">

                </div>

                <!-- structure select widget -->
                <div class="form-group">
                    <div class="input-group input-group-sm">
                        <input id="trace3d_structure_select_input" type="text" class="form-control text-center">
                        <div class="input-group-append">
                            <button id="trace3d_structure_select_button_minus" class="btn btn-outline-secondary" type="button"><i class="fas fa-minus"></i></button>
                            <button id="trace3d_structure_select_button_plus" class="btn btn-outline-secondary" type="button"><i class="fas fa-plus"></i></button>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <!-- juicebox panel -->
        <div id="trace3d_juicebox_panel" class="card">

            <div class="card-body p-0">

                <!-- drag handle-->
                <div class="trace3d_card_drag_container">
                    <i class="fas fa-sm fa-grip-horizontal"></i>
                </div>

                <!-- juicebox browser container -->
                <div id="trace3d_juicebox_root_container"></div>

            </div>

        </div>

        <!-- igvjs panel -->
        <div id="trace3d_igv_panel" class="card">

            <div id="trace3d_igv_container" class="card-body">

                <!-- drag handle -->
                <div class="trace3d_card_drag_container">

                    <i class="fas fa-sm fa-grip-horizontal"></i>

                </div>

                <!-- igv browser container -->
                <div id="trace3d_igv_root_container">

                </div>

            </div>

        </div>

        <!-- thumbnail palette -->
        <div id="trace3d_thumbnail_panel" class="card">

            <!-- thumbnail palette body -->
            <div id="trace3d_thumbnail_panel_body" class="card-body p-0">

                <!-- drag handle -->
                <div class="trace3d_card_drag_container">
                    <i class="fas fa-grip-lines"></i>
                </div>

                <!-- thumbnail container -->
                <div id="trace3d_thumbnail_container">
                    <canvas>
                    </canvas>
                </div>

            </div>

        </div>

    </div>

    <!-- Structures CSV File Select Modal -->
    <div id="trace3d-file-load-select-modal" class="modal fade">

        <div class="modal-dialog">

            <div class="modal-content">

                <div class="modal-header">

                    <div class="modal-title">Select File</div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">
                    <div>
                        <div class="input-group my-3">

                            <div class="spinner-border" style="display: none;">
                                <!-- spinner border-radius: .25rem; -->
                            </div>

                            <select class="form-control custom-select">


                                <!-- See: https://github.com/BogdanBintu/ChromatinImaging/tree/master/Data -->

                                <option selected>Choose...</option>

                                <!-- hg38: 18,627,714 - 20,577,518 -->
                                <option value="https://www.dropbox.com/s/ycbj30umsu0y809/IMR90_chr21-18-20Mb.csv?dl=0">IMR90 chr21:18-20</option>

                                <!-- hg38: 28,000,071 - 29,949,939 -->
                                <option value="https://www.dropbox.com/s/ja43wef9gijubta/A549_chr21-28-30Mb.csv?dl=0">A549 chr21:28-30</option>
                                <option value="https://www.dropbox.com/s/yhlqs6w3sdi6z08/HCT116_chr21-28-30Mb_6h_auxin.csv?dl=0">HCT116 chr21:28-30 - 6h auxin</option>
                                <option value="https://www.dropbox.com/s/s96fn3ca3wdon4k/HCT116_chr21-28-30Mb_untreated.csv?dl=0">HCT116 chr21:28-30 - untreated</option>
                                <option value="https://www.dropbox.com/s/ifydtm0b730baqu/IMR90_chr21-28-30Mb_cell_cycle.csv?dl=0">IMR90 chr21:28-30 - cell cycle</option>
                                <option value="https://www.dropbox.com/s/vi2t8p8gu5u13ag/IMR90_chr21-28-30Mb.csv?dl=0">IMR90 chr21:28-30</option>
                                <option value="https://www.dropbox.com/s/u7je35e95zykzbn/K562_chr21-28-30Mb.csv?dl=0">K562 chr21:28-30</option>

                                <!-- hg38: 34,628,096 - 37,117,534  -->
                                <option value="https://www.dropbox.com/s/sqfrqweqeg4so22/HCT116_chr21-34-37Mb_6h_auxin.csv?dl=0">HCT116 chr21:34-37 - 6h auxin</option>
                                <option value="https://www.dropbox.com/s/qbvvnopakr016ps/HCT116_chr21-34-37Mb_auxin_cellDiv.csv?dl=0">HCT116 chr21:34-37 - auxin cellDiv</option>
                                <option value="https://www.dropbox.com/s/vy48d4vsa3m5np4/HCT116_chr21-34-37Mb_untreated.csv?dl=0">HCT116 chr21:34-37 - untreated</option>


                            </select>
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </div>

    <!-- Structure CSV URL Modal -->
    <div id="trace3d-file-load-url-modal" class="modal fade">

        <div class="modal-dialog">

            <div class="modal-content">

                <div class="modal-header">

                    <div class="modal-title">Load File From URL</div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">
                    <div>
                        <div class="input-group">
                            <div class="spinner-border" style="display: none;">
                                <!-- spinner -->
                            </div>
                            <input class="form-control" type="text" placeholder="Enter URL">
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-sm btn-secondary">OK</button>
                </div>

            </div>

        </div>

    </div>

    <!-- IGV Track Modal -->
    <div id="igv-app-track-from-url-modal" class="modal fade">

        <div class="modal-dialog modal-lg" role="document">

            <div class="modal-content">

                <div class="modal-header">
                    <div id="igv-app-track-from-url-modal-label" class="modal-title">Track URL</div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-sm btn-secondary">OK</button>
                </div>

            </div>

        </div>

    </div>

    <!-- IGV Generic Track Select Modal -->
    <div id="igv-app-generic-track-select-modal" class="modal fade">

        <div class="modal-dialog modal-lg" role="document">

            <div class="modal-content">

                <div class="modal-header">
                    <div id="igv-app-generic-track-select-modal-label" class="modal-title">
                    </div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">

                    <div class="form-group">
                        <select class="form-control">
                        </select>
                    </div>

                </div>

            </div>

        </div>

    </div>

    <!-- IGV Multiple File Load Modal -->
    <div id="igv-app-multiple-file-load-modal" class="modal">

        <div class="modal-dialog modal-lg" role="document">

            <div class="modal-content">

                <div class="modal-header">
                    <div id="igv-app-multiple-file-load-modal-label" class="modal-title">
                    </div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div id="igv-app-multiple-file-load-modal-body" class="modal-body">
                </div>

            </div>

        </div>

    </div>

    <!-- ENCODE Modal -->
    <div id="igv-app-encode-modal" class="modal fade">

        <div class="modal-dialog modal-xl">

            <div class="modal-content">

                <div class="modal-header">
                    <div class="modal-title">ENCODE</div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">

                    <div id="igv-encode-spinner-container">
                        <div id="igv-encode-spinner" class="spinner-border" style="display: none;">
                            <!-- spinner -->
                        </div>
                    </div>

                    <div id="igv-encode-datatable">

                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">OK</button>
                </div>

            </div>

        </div>

    </div>

    <!-- Contact Map Select Modal -->
    <div id="hic-contact-map-select-modal" class="modal fade">

        <div class="modal-dialog">

            <div class="modal-content">

                <div class="modal-header">

                    <div class="modal-title">Select File</div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">
                    <div>
                        <div class="input-group my-3">

                            <div class="spinner-border" style="display: none;">
                                <!-- spinner border-radius: .25rem; -->
                            </div>

                            <select class="form-control custom-select">

                            </select>
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </div>

    <!-- Contact Map URL Modal -->
    <div id="hic-load-url-modal" class="modal fade">

        <div class="modal-dialog">

            <div class="modal-content">

                <div class="modal-header">

                    <div class="modal-title">Load File From URL</div>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>

                </div>

                <div class="modal-body">
                    <div>
                        <div class="input-group">
                            <div class="spinner-border" style="display: none;">
                                <!-- spinner -->
                            </div>
                            <input class="form-control" type="text" placeholder="Enter URL">
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-sm btn-secondary">OK</button>
                </div>

            </div>

        </div>

    </div>

</main>

</body>

</html>
